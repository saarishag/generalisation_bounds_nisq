import pandas as pd

def local_global_results():
    """   
    Format: (p_local, mean_local_acc, std_local_acc, mean_global_acc, std_global_acc)
    """

    heart_data = [
        (0,0.8248087431693989,0.04121588095508379, 0.8248087431693989, 0.04121588095508379),
        (0.05,0.8182513661202184,0.030980474201008756,0.8248087431693989,0.036951529191229744),
        (0.1,0.8083060109289617, 0.03707423754109027, 0.8215300546448088, 0.03346047596612635),  
        (0.2, 0.6858469945355192,0.14479043084542303, 0.7552459016393442, 0.0815926597121623),
        (0.3, 0.5834972677595629, 0.16031790433944096, 0.6297814207650273,0.18175047398429056), 
        (0.375, 0.5243169398907104 ,0.14283739086991004,0.5931693989071037, 0.18649497485384), 
        (0.5, 0.46530054644808744, 0.05495540147223879,0.5079234972677595,0.1346703545420709), 
        (0.6, 0.45874316939890714,0.044548089010248794 ,0.45874316939890714,0.044548089010248794 ),
        (0.7,0.45874316939890714,0.044548089010248794, 0.45874316939890714, 0.044548089010248794 ),
        (0.75, 0.45874316939890714, 0.044548089010248794, 0.45874316939890714,0.044548089010248794 ),
    ]

    wine_2N1L = [

    (0, 0.6533333333333333,0.04988876515698587, 0.6533333333333333,0.04988876515698587 ),
    (0.1,0.6300000000000001,0.03858612300930072 ,0.6366666666666667, 0.04396968652757639), 
    (0.2, 0.5433333333333333 , 0.06716480559869963, 0.61,0.044221663871405324 ),
    (0.25, 0.5233333333333334,0.05637178175095922, 0.5633333333333332, 0.03858612300930076),
    (0.3,0.4833333333333334 , 0.08498365855987976, 0.51,0.0992191737742481), 
    (0.35 ,0.44000000000000006,0.08069145624606805, 0.4766666666666667,0.10519822558706333),
    (0.375,0.4133333333333334,0.06446359868604573, 0.47000000000000003,0.09854496999396324),
    (0.4, 0.4166666666666667 ,0.0632455532033676 , 0.44333333333333336 ,0.07717224601860151),
    (0.45,0.4166666666666667 , 0.0632455532033676,0.4166666666666667 , 0.0632455532033676),
    (0.5,0.4166666666666667 , 0.0632455532033676 , 0.4166666666666667 , 0.0632455532033676),
    (0.6,0.4166666666666667 , 0.0632455532033676, 0.4166666666666667 , 0.0632455532033676,),
    (0.75,0.4166666666666667 , 0.0632455532033676,0.4166666666666667 , 0.0632455532033676), 

    ]

    wine_3N1L = [
    (0,0.64,0.05637178175095917, 0.64,0.05637178175095917),
    (0.1,0.6266666666666667 ,0.04666666666666665,0.6433333333333333 , 0.044221663871405324),
    (0.2,0.6266666666666667 , 0.037416573867739396,0.6300000000000001 , 0.037118429085533464),
    (0.25,0.59 , 0.0429469957557504,0.6166666666666666 , 0.03162277660168381),
    (0.3,0.5566666666666668 , 0.04784233364802442,0.5833333333333333 , 0.0447213595499958),
    (0.35, 0.5166666666666667 , 0.053748384988656986, 0.53,0.0635959467611297),
    (0.375,0.5233333333333334 , 0.051207638319124046,0.5166666666666667 , 0.053748384988656986),
    (0.4,0.5033333333333334 , 0.05617433182117572,0.49333333333333335, 0.06548960901462832), 
    (0.45,0.47333333333333333 ,0.0946337971105226, 0.47000000000000003 , 0.10022197585581939),
    (0.5,0.47000000000000003 ,0.10022197585581939,0.47000000000000003, 0.10022197585581939),
    (0.6,0.47000000000000003 ,0.10022197585581939,0.47000000000000003 ,0.10022197585581939),
    (0.75,0.47000000000000003,0.10022197585581939 ,0.47000000000000003 , 0.10022197585581939) 
    ]

    return heart_data, wine_2N1L, wine_3N1L


def margin_results():
    p_local_list = [0,0.05,0.1,0.25,0.375,0.5,0.75]
    heart_margin = [0.16740862338544887, 0.13384389223996065,  0.10243140450410765, 0.04654498929105347, 0.020052512412971187, 0.006585789451575739, 0.001967244930069497]
    gaus_margin = [0.06662847412280092, 0.05231107104254029, 0.0415573801018878, 0.018685106062826834,  0.009406816664064824, 0.002904496998082465, 0.00014717672555800701]
    bc_margin = [0.030265367540619283,0.023988142969443592,0.018770788550924514,
                        0.008573209110820027,0.003866396985579238,0.0012859428366750066,
                        9.349105941676116e-06]
    wineL1_margin = [0.062356493459492124,0.04874936454977002,0.038199434321940916,0.02126833605682352, 0.008088056724590833, 0.002551516998417873,2.78103219572828e-05]

    wineL2_margin = [0.06342523158268312,0.007356444770524798,0.004908624954027026,
                        0.0013036285059035227,0.0006925640052089707, 0.00028485638954170553,4.0008118151808765e-05]
    
    return p_local_list,heart_margin, gaus_margin, bc_margin, wineL1_margin, wineL2_margin

def upper_bound_results():
    p_local_list = [0,0.05,0.1,0.25,0.375,0.5,0.75]
    heart_upper = [0.2525252331482871,0.19111364505760609,  0.15320560292066435, 0.08885765532687485, 0.05764552518279823, 0.035665876786126934, 0.008732609115352764]
    gaus_upper = [0.19897583540332298, 0.11022340065276134, 0.07991871989127752, 0.04201471563153883, 0.026569785250692302, 0.016258553563406497, 0.0039557268751735245]
    bc_upper = [0.030358302586512946,0.025155761061244102,0.021200887168802342,
                    0.013149961214320455,0.008716707788991208,0.005447175907896808,
                    0.0013416168246656007]
    wineL1_upper = [0.11882787481212649,0.09772728456095309, 0.08197597406984446,0.050490185326003786, 0.03338688581346709,0.020839664188184316,0.005129144939185017]
    wineL2_upper = [0.06404251937233418,0.0449746918284536,0.03338433532755175,
                    0.014612647979490247, 0.006906899102264266, 0.0028151260261482128, 0.00017577197348998564]
    
    return p_local_list, heart_upper, gaus_upper, bc_upper, wineL1_upper, wineL2_upper


def lower_bound_results():
    p_local_list = [0,0.01,0.05,0.07,0.1,0.135,0.15]
    heart_lower = [0.06376899337659676,0.05874348782195379, 0.04011149394629656,
                0.031636053965482996, 0.01990867973217351,0.00763195610671373,0.0028066328209874515
    ]
    gaus_lower = [0.03967477299353278,0.03654808427695391,0.024955928147594533,
                    0.019682814374679027, 0.012386464128580937, 0.00474832845866436,
                        0.0017461859463778534 ]
    bc_lower = [0.0009216265359342784, 0.0008489950103229005,0.0005797146114343601,
                    0.00045722262941566956,0.0002877318045186817, 0.00011030146308714431,
                        4.056308791280723e-05]
    wineL1_lower = [0.014120063832366404,0.013007290124266548,0.00888169665135637,
                        0.007005020429893573,0.004408283928464792, 0.001689907613190673,
                        0.0006214593094220234  ]
    wineL2_lower = [0.0041014442875558004, 0.003778217748170988, 0.0025798597249261914,
                    0.0020347429988624667, 0.001280470906574921,0.0004908661893390572,
                        0.0001805148167060488 ]
    return p_local_list, heart_lower, gaus_lower, bc_lower, wineL1_lower, wineL2_lower


def boxplot_results():

    levels = [0, 0.5, 1.0]

    #HTRU2 Dataset

    #Load the dataset
    url = "data/GeomMargins_HTRU2.csv"
    htru2 = pd.read_csv(url)

    htru2_subset = htru2[htru2.iloc[:,0].isin(levels)]

    corr = htru2_subset.iloc[:,0]
    geom = htru2_subset.iloc[:,1]

    htru2_df = pd.DataFrame(
        {
            'corruption_levels': corr,
            'geometric_margin': geom,
        }
    ) 

    htru2_df['corruption_levels'] = htru2_df['corruption_levels'].astype(str)

    #Wine Dataset
    url = "data/GeomMargins_Wine.csv"
    wine = pd.read_csv(url)

    wine_subset = wine[wine.iloc[:,0].isin(levels)]
    
    corr = wine_subset.iloc[:,0]
    geom = wine_subset.iloc[:,1]

    wine_df = pd.DataFrame(
        {
            'corruption_levels': corr,
            'geometric_margin': geom
        }
    ) 

    wine_df['corruption_levels'] = wine_df['corruption_levels'].astype(str)

    #Heart Dataset
    url = "data/GeomMargins_Heart.csv"
    heart = pd.read_csv(url)

    heart_subset = heart[heart.iloc[:,0].isin(levels)]

    corr = heart_subset.iloc[:,0]
    geom = heart_subset.iloc[:,1]

    heart_df = pd.DataFrame(
        {
            'corruption_levels': corr,
            'geometric_margin': geom,
        }
    ) 

    heart_df['corruption_levels'] = heart_df['corruption_levels'].astype(str)

    #Gaussian Dataset
    url = "data/GeomMargins_Gaus.csv"
    gaus = pd.read_csv(url)

    gaus_subset = gaus[gaus.iloc[:,0].isin(levels)]

    corr = gaus_subset.iloc[:,0]
    geom = gaus_subset.iloc[:,1]

    gaus_df = pd.DataFrame(
        {
            'corruption_levels': corr,
            'geometric_margin': geom,
        }
    ) 

    gaus_df['corruption_levels'] = gaus_df['corruption_levels'].astype(str)
    
    return htru2_df, wine_df, heart_df, gaus_df

def acc_margin_results(htru2_df, wine_df, heart_df, gaus_df):

    htru2_acc = [0.967, 0.963, 0.96, 0.626, 0.047, 0.044, 0.033]
    htru2_std = [0.026, 0.018, 0.024, 0.325, 0.025, 0.016, 0.016]

    median_margins = htru2_df.groupby('corruption_levels').agg({
        'geometric_margin':'median',
    }).reset_index()

    htru2_geom_margin = median_margins['geometric_margin']

    wine_acc = [0.717, 0.717, 0.717, 0.55, 0.307, 0.305, 0.288]
    wine_std = [0.072, 0.071, 0.069, 0.125, 0.080, 0.061, 0.072]

    
    median_margins = wine_df.groupby('corruption_levels').agg({
        'geometric_margin':'median',
    }).reset_index()

    wine_geom_margin = median_margins['geometric_margin']

    heart_acc = [0.826, 0.824, 0.824, 0.533,0.348, 0.234, 0.176]
    heart_std = [0.042, 0.050, 0.043, 0.073, 0.06, 0.042, 0.045]
    
    
    median_margins = heart_df.groupby('corruption_levels').agg({
        'geometric_margin':'median',
    }).reset_index()

    heart_geom_margin = median_margins['geometric_margin']

    gaus_acc = [0.843, 0.827, 0.843, 0.47, 0.352, 0.161, 0.157]
    gaus_std = [0.034, 0.052, 0.030, 0.060, 0.114, 0.026, 0.041]
    

    median_margins = gaus_df.groupby('corruption_levels').agg({
        'geometric_margin':'median',
    }).reset_index()

    gaus_geom_margin = median_margins['geometric_margin']

    return htru2_acc, htru2_std, htru2_geom_margin, wine_acc, wine_std, wine_geom_margin, heart_acc, heart_std, heart_geom_margin, gaus_acc, gaus_std, gaus_geom_margin

